---
import PageLayout from "@/layouts/Base.astro";

const meta = {
	description:
		"Discover Aurras - a sophisticated Python-powered terminal music player that transforms your command line into a feature-rich music hub with Spotify integration, synced lyrics, and beautiful themes.",
	title: "About Aurras",
};

// High-performance data fetching with rate limit avoidance
let githubStars = "23"; // fallback value - will be updated if API succeeds
let totalDownloads = "1K+"; // realistic estimate based on PyPI + GitHub releases

// Multiple strategies to fetch GitHub stars, avoiding rate limits
try {
	const controller = new AbortController();
	const timeoutId = setTimeout(() => controller.abort(), 2000);

	// Strategy 1: Try the public GitHub API with minimal headers (less likely to be rate limited)
	async function fetchGitHubStars() {
		try {
			const response = await fetch(
				"https://api.github.com/repos/vedant-asati03/Aurras",
				{
					signal: controller.signal,
					// Minimal headers to avoid detection
					cache: "no-cache",
				},
			);

			if (response.ok) {
				const data = await response.json();
				if (data.stargazers_count !== undefined) {
					return data.stargazers_count;
				}
			} else if (response.status === 403) {
				throw new Error(`Rate limited: ${response.status}`);
			} else {
				throw new Error(
					`HTTP ${response.status}: ${response.statusText}`,
				);
			}
		} catch (error) {
			throw error;
		}
	}

	// Strategy 2: Alternative approach using different endpoint
	async function fetchGitHubStarsAlt() {
		try {
			// Use search API as fallback (different rate limit pool)
			const response = await fetch(
				"https://api.github.com/search/repositories?q=repo:vedant-asati03/Aurras",
				{
					signal: controller.signal,
					cache: "no-cache",
				},
			);

			if (response.ok) {
				const data = await response.json();
				if (
					data.items &&
					data.items[0] &&
					data.items[0].stargazers_count !== undefined
				) {
					return data.items[0].stargazers_count;
				}
			}
			throw new Error(`Search API failed: ${response.status}`);
		} catch (error) {
			throw error;
		}
	}

	// Try strategies in order
	let stars = null;
	const strategies = [fetchGitHubStars, fetchGitHubStarsAlt];

	for (const strategy of strategies) {
		try {
			stars = await strategy();
			if (typeof stars === "number" && stars >= 0) {
				githubStars = stars.toString();
				if (import.meta.env.DEV) {
					console.log(
						`âœ… Successfully fetched ${stars} GitHub stars`,
					);
				}
				break;
			}
		} catch (strategyError) {
			if (import.meta.env.DEV) {
				console.warn(
					`Strategy failed:`,
					strategyError instanceof Error
						? strategyError.message
						: strategyError,
				);
			}
			continue;
		}
	}

	clearTimeout(timeoutId);
} catch (error) {
	// Graceful degradation - use fallbacks
	if (import.meta.env.DEV) {
		console.warn(
			"All GitHub API strategies failed:",
			error instanceof Error ? error.message : "Unknown error",
		);
		console.info(`Using fallback star count: ${githubStars}`);
	}
}
---

<PageLayout meta={meta}>
	<h1 class="title mb-6">About Aurras</h1>

	<div class="max-w-none">
		<p class="text-base sm:text-lg mb-8">
			Dive into the essence of Aurras. Discover a terminal music
			experience meticulously crafted for focus, flow, and pure audio
			enjoyment.
		</p>

		<div
			class="flex flex-col sm:flex-row justify-center gap-3 sm:gap-4 mb-12"
		>
			<a
				href="https://github.com/vedant-asati03/Aurras"
				class="inline-flex items-center px-6 py-3 rounded-lg bg-gradient-to-r from-accent-one to-accent-two text-bgColor font-semibold hover:brightness-110 transition-all text-sm sm:text-base"
				target="_blank"
				rel="noreferrer"
			>
				Get Aurras
			</a>
			<a
				href="/features/"
				class="inline-flex items-center px-6 py-3 rounded-lg border border-accent-one text-accent-one hover:bg-accent-one/10 transition-all text-sm sm:text-base"
			>
				Explore Features
			</a>
		</div>

		<!-- What is Aurras Section -->
		<div class="mb-16">
			<h2 class="title text-3xl font-bold mb-8">
				The Soul of Sound, Reimagined
			</h2>

			<div class="grid gap-6 md:grid-cols-2 items-center">
				<div class="space-y-6">
					<p class="text-base sm:text-lg">
						Aurras is more than a music player; it's a philosophy.
						It's about reclaiming your auditory space within the
						digital realm, offering a sanctuary where music, lyrics,
						and aesthetics converge seamlessly.
					</p>
					<p class="text-base sm:text-lg">
						We believe in the power of focused listening, the beauty
						of a personalized environment, and the elegance of
						command-line mastery. It's an experience designed for
						those who appreciate the craft, both in music and in the
						tools they use.
					</p>
					<p class="text-base sm:text-lg">
						Aurras invites you to a world where your terminal
						becomes a stage for sound, perfectly tuned to your
						workflow and your style.
					</p>
					<a
						href="/features/"
						class="inline-flex items-center px-6 py-3 rounded-lg bg-gradient-to-r from-accent-one to-accent-two text-bgColor font-semibold hover:brightness-110 transition-all text-sm sm:text-base"
					>
						Explore All Features
					</a>
				</div>

				<div class="mt-8 md:mt-0">
					<img
						src="/aurras.png"
						alt="Aurras Terminal Music Player Interface"
						class="rounded-lg shadow-lg w-full"
					/>
				</div>
			</div>
		</div>

		<!-- Statistics & Community Section -->
		<div class="mb-16">
			<h2 class="title text-3xl font-bold mb-8 text-center">
				By the Numbers, For the Community
			</h2>

			<div
				class="grid gap-6 sm:grid-cols-2 lg:grid-cols-4 max-w-4xl mx-auto mb-8"
			>
				<div
					class="p-6 rounded-lg border border-accent-one/20 bg-gradient-to-br from-accent-one/5 to-accent-two/5 text-center"
				>
					<div class="text-3xl font-bold text-accent-one mb-2">
						10
					</div>
					<div class="text-sm sm:text-base">Built-in Themes</div>
				</div>

				<div
					class="p-6 rounded-lg border border-accent-two/20 bg-gradient-to-br from-accent-two/5 to-accent-one/5 text-center"
				>
					<div class="text-3xl font-bold text-accent-two mb-2">3</div>
					<div class="text-sm sm:text-base">Supported Platforms</div>
				</div>

				<div
					class="p-6 rounded-lg border border-accent-one/20 bg-gradient-to-br from-accent-one/5 to-accent-two/5 text-center"
				>
					<div class="text-3xl font-bold text-accent-one mb-2">
						{totalDownloads}
					</div>
					<div class="text-sm sm:text-base">Total Downloads</div>
				</div>

				<div
					class="p-6 rounded-lg border border-accent-two/20 bg-gradient-to-br from-accent-two/5 to-accent-one/5 text-center"
				>
					<div class="text-3xl font-bold text-accent-two mb-2">
						{githubStars}
					</div>
					<div class="text-sm sm:text-base">GitHub Stars</div>
				</div>
			</div>

			<p class="text-base sm:text-lg text-center">
				Aurras is built with passion for a vibrant community and is
				freely available for everyone. Your contributions and feedback
				help shape its future!
			</p>
		</div>

		<!-- Call to Action Section -->
		<div
			class="p-6 sm:p-8 text-center rounded-lg bg-gradient-to-r from-accent-one/10 to-accent-two/10 border border-accent-one/20"
		>
			<h2 class="text-2xl sm:text-3xl font-bold mb-4">
				Ready to Transform Your Terminal?
			</h2>
			<p class="text-base sm:text-lg mb-6">
				Join developers worldwide who have made Aurras their go-to
				terminal music solution. Experience the perfect blend of
				functionality and elegance.
			</p>
			<div
				class="flex flex-col sm:flex-row justify-center gap-3 sm:gap-4"
			>
				<a
					href="https://github.com/vedant-asati03/Aurras"
					class="inline-flex items-center px-6 py-3 rounded-lg bg-gradient-to-r from-accent-one to-accent-two text-bgColor font-semibold hover:brightness-110 transition-all text-sm sm:text-base"
					target="_blank"
					rel="noreferrer"
				>
					Get Aurras & Star on GitHub
				</a>
				<a
					href="/features/"
					class="inline-flex items-center px-6 py-3 rounded-lg border border-accent-one text-accent-one hover:bg-accent-one/10 transition-all text-sm sm:text-base"
				>
					Explore All Features
				</a>
			</div>
		</div>
	</div>
</PageLayout>
